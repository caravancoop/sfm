{% load citations %}
{% load i18n %}
{% load help %}
<h3 id="memberships">
    <i class="fa fa-fw fa-users"></i>
    {% trans "Postings" %}
    <small class="pull-right">{% help href='whowasincommand/personsrec.html#person_record_anatomy_memberships' %}</small>
</h3>
<hr />
<table class="table table-condensed">
    <thead>
        <tr>
            <th>{% trans "Organization" %}</th>
            <th>{% trans "Rank" %}</th>
            <th>{% trans "Role" %}</th>
            <th>{% trans "Title" %}</th>
            <th>{% trans "First cited" %}</th>
            <th>{% trans "Last cited" %}</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        {% for member in memberships %}
            {% with organization=member.organization.get_value.value %}

                {% if member.id == object.id %}
                <tr class="bg-info">
                {% else %}
                <tr>
                {% endif %}
                    <td class="cited">
                        <a href="{% url 'view-organization' organization.uuid %}">
                            {{ organization.name.get_value }}
                        </a>
                        {% cite organization.name.get_value %}
                    </td>
                    <td class="cited">
                        {{ member.rank.get_value.value.value|default:"" }}
                        {% cite member.rank.get_value %}
                    </td>
                    <td class="cited">
                        {{ member.role.get_value.value.value|default:"" }}
                        {% cite member.role.get_value %}
                    </td>
                    <td class="cited">
                        {{ member.title.get_value|default:"" }}
                        {% cite member.title.get_value|default:"" %}
                    </td>
                    <td class="cited">
                        {{ member.firstciteddate.get_value.value }}
                        {% cite member.firstciteddate.get_value %}
                    </td>
                    <td class="cited">
                        {{ member.lastciteddate.get_value.value }}
                        {% cite member.lastciteddate.get_value %}
                    </td>
                    <td>
                        {% if request.user.is_staff %}
                        <a href="{% url 'edit-person-postings' member.member.get_value.value.uuid member.id %}">
                            <i class="fa fa-pencil"> </i>
                        </a>
                        {% endif %}
                    </td>
                </tr>
            {% endwith %}
        {% endfor %}
        {% if 'edit' in request.path %}
        <tr>
            <td colspan="7">
                <i class="fa fa-plus"> </i> Add posting
            </td>
        </tr>
        {% endif %}
    </tbody>
</table>
