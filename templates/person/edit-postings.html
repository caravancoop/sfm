{% extends 'person/edit.html' %}
{% load i18n %}
{% load countries %}

{% block above_form %}
    {% include 'person/partials/person-posting-list.html'%}
{% endblock %}

{% block form_content %}
    <h2>{% trans 'Edit postings' %}</h2>
    <div class="row organization-row field-bg bg-info">
        <div class="col-sm-12">
            {% if form.organization.errors %}
                <div class="form-group has-error has-feedback">
            {% else %}
                <div class="form-group">
            {% endif %}
                <label class="control-label">{% trans "Organization" %}</label>
                <select id="id_organization" class="form-control sourced" name="organization">
                    <option value="{{ form.instance.organization.get_value.id }}">{{ form.instance.organization.get_value.value }}</option>
                </select>
                {% if form.organization.errors %}
                    {% for error in form.organization.errors %}
                    <span class="help-block"><i class="fa fa-remove"> </i> {{error}}</span>
                    {% endfor %}
                {% endif %}
            </div>
        </div>
    </div>
{% endblock %}
{% block extra_extra_js %}
    <script type="text/javascript">
        $(document).ready(function(){
            loadSources({'target': $('#id_organization')});

            $('#id_organization').select2({
                ajax: {
                    url: "{% url 'organization-autocomplete' %}",
                    data: function(params){
                        var query = {
                            q: params.term
                        }
                        return query
                    }
                }
            });

        })
    </script>
{% endblock %}
