{% load i18n %}
{% load arithmetic %}

{% if page.has_previous or page.has_next %}
<nav aria-label="{% trans 'Search results navigation' %}">
  <ul class="pagination">

    <! -- Previous button -->
    {% if page.has_previous %}
    <li>
        <a href="?{{ q_filters }}&amp;{{ page_type  }}_page={{ page.previous_page_number }}" aria-label="Previous">
        <span aria-hidden="true">&laquo; {% trans "Previous" %}</span>
      </a>
    </li>
    {% endif %}

    <!-- Page numbers -->
    {% if paginator.num_pages >= 10 and page.number >= 9 %}
    <!-- First page + ellipses -->
    <li><a href="?{{ q_filters }}&amp;{{ page_type }}_page=1">1</a></li>
    <li class="disabled"><a href="#">&#8230;</a></li>
    {% endif %}

    {% for num in paginator.page_range %}
        {% if not forloop.last and page.number|absubtract:num < 5 %}
            <li{% if num == page.number %} class="active"{% endif %}>
                <a href="?{{ q_filters }}&amp;{{ page_type }}_page={{ num }}">
                    {{ num }}
                </a>
            </li>
        {% endif %}
    {% endfor %}

    {% if paginator.num_pages >= 10 %}
        {% if paginator.num_pages|subtract:page.number >= 10 %}
            <! -- Ellipses before the last page -->
            <li class="disabled"><a href="#">&#8230;</a></li>
        {% endif %}
    {% endif %}

    <!-- Last page -->
    <li{% if paginator.num_pages == page.number %} class="active"{% endif %}>
        <a href="?{{ q_filters }}&amp;{{ page_type }}_page={{ paginator.num_pages }}">
            {{ paginator.num_pages }}
        </a>
    </li>

    <!-- Next button -->
    {% if page.has_next %}
    <li>
        <a href="?{{ q_filters }}&amp;page={{ page.next_page_number }}" aria-label="Next">
        <span aria-hidden="true">{% trans "Next" %} &raquo;</span>
      </a>
    </li>
    {% endif %}

  </ul>
</nav>

<!-- Results per page -->
<!-- TODO: Fix this -->
{% if hit_count > 5 %}
<div class="row">
    <div class="col-sm-12">
        <p>
            <small>
                <strong>{% trans "Results per page:" %}</strong>
                {% for result_count in results_per_page %}
                    {% if hit_count >= result_count %}
                        {% if not forloop.first %}|{% endif %}
                        <a href="?{{ q_filters }}&amp;{{ page_type }}_rows={{ result_count }}">
                            {% if page.result_count == result_count %}
                                <strong>{{ result_count }}</strong>
                            {% else %}
                                {{ result_count }}
                            {% endif %}
                        </a>
                    {% endif %}
                {% endfor %}
            </small>
        </p>
    </div>
</div>
{% endif %}
{% endif %}
